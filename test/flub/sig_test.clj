;; -*- coding: utf-8 -*-
;;
;; Â© 2013 Buster Marx, Inc All rights reserved.
;; Author: Ian Eure <ian.eure@gmail.com>
;;
(ns flub.sig-test
  (:use [clojure.test])
  (:require [flub.sig :as s]))

(deftest test-simple-sig
  (is (= 0x4660 (s/signature [1 2 3 4 5]))))

(deftest test-shiftbits
  (is (= 2r00000000 (s/shiftbits 2r00000000)))
  (is (= 2r00000000 (s/shiftbits 2r00000001)))
  (is (= 2r00000000 (s/shiftbits 2r00000010)))
  (is (= 2r00000000 (s/shiftbits 2r00000011)))
  (is (= 2r00000000 (s/shiftbits 2r00000100)))
  (is (= 2r00000000 (s/shiftbits 2r00000101)))
  (is (= 2r00000000 (s/shiftbits 2r00000110)))
  (is (= 2r00000000 (s/shiftbits 2r00000111)))
  (is (= 2r00000000 (s/shiftbits 2r00001000)))
  (is (= 2r00000000 (s/shiftbits 2r00001001)))
  (is (= 2r00000000 (s/shiftbits 2r00001010)))
  (is (= 2r00000000 (s/shiftbits 2r00001011)))
  (is (= 2r00000000 (s/shiftbits 2r00001100)))
  (is (= 2r00000000 (s/shiftbits 2r00001101)))
  (is (= 2r00000000 (s/shiftbits 2r00001110)))
  (is (= 2r00000000 (s/shiftbits 2r00001111)))
  (is (= 2r00000000 (s/shiftbits 2r00010000)))
  (is (= 2r00000000 (s/shiftbits 2r00010001)))
  (is (= 2r00000000 (s/shiftbits 2r00010010)))
  (is (= 2r00000000 (s/shiftbits 2r00010011)))
  (is (= 2r00000000 (s/shiftbits 2r00010100)))
  (is (= 2r00000000 (s/shiftbits 2r00010101)))
  (is (= 2r00000000 (s/shiftbits 2r00010110)))
  (is (= 2r00000000 (s/shiftbits 2r00010111)))
  (is (= 2r00000000 (s/shiftbits 2r00011000)))
  (is (= 2r00000000 (s/shiftbits 2r00011001)))
  (is (= 2r00000000 (s/shiftbits 2r00011010)))
  (is (= 2r00000000 (s/shiftbits 2r00011011)))
  (is (= 2r00000000 (s/shiftbits 2r00011100)))
  (is (= 2r00000000 (s/shiftbits 2r00011101)))
  (is (= 2r00000000 (s/shiftbits 2r00011110)))
  (is (= 2r00000000 (s/shiftbits 2r00011111)))
  (is (= 2r00000000 (s/shiftbits 2r00100000)))
  (is (= 2r00000000 (s/shiftbits 2r00100001)))
  (is (= 2r00000000 (s/shiftbits 2r00100010)))
  (is (= 2r00000000 (s/shiftbits 2r00100011)))
  (is (= 2r00000000 (s/shiftbits 2r00100100)))
  (is (= 2r00000000 (s/shiftbits 2r00100101)))
  (is (= 2r00000000 (s/shiftbits 2r00100110)))
  (is (= 2r00000000 (s/shiftbits 2r00100111)))
  (is (= 2r00000000 (s/shiftbits 2r00101000)))
  (is (= 2r00000000 (s/shiftbits 2r00101001)))
  (is (= 2r00000000 (s/shiftbits 2r00101010)))
  (is (= 2r00000000 (s/shiftbits 2r00101011)))
  (is (= 2r00000000 (s/shiftbits 2r00101100)))
  (is (= 2r00000000 (s/shiftbits 2r00101101)))
  (is (= 2r00000000 (s/shiftbits 2r00101110)))
  (is (= 2r00000000 (s/shiftbits 2r00101111)))
  (is (= 2r00000000 (s/shiftbits 2r00110000)))
  (is (= 2r00000000 (s/shiftbits 2r00110001)))
  (is (= 2r00000000 (s/shiftbits 2r00110010)))
  (is (= 2r00000000 (s/shiftbits 2r00110011)))
  (is (= 2r00000000 (s/shiftbits 2r00110100)))
  (is (= 2r00000000 (s/shiftbits 2r00110101)))
  (is (= 2r00000000 (s/shiftbits 2r00110110)))
  (is (= 2r00000000 (s/shiftbits 2r00110111)))
  (is (= 2r00000000 (s/shiftbits 2r00111000)))
  (is (= 2r00000000 (s/shiftbits 2r00111001)))
  (is (= 2r00000000 (s/shiftbits 2r00111010)))
  (is (= 2r00000000 (s/shiftbits 2r00111011)))
  (is (= 2r00000000 (s/shiftbits 2r00111100)))
  (is (= 2r00000000 (s/shiftbits 2r00111101)))
  (is (= 2r00000000 (s/shiftbits 2r00111110)))
  (is (= 2r00000000 (s/shiftbits 2r00111111)))
  (is (= 2r00000001 (s/shiftbits 2r01000000)))
  (is (= 2r00000001 (s/shiftbits 2r01000001)))
  (is (= 2r00000001 (s/shiftbits 2r01000010)))
  (is (= 2r00000001 (s/shiftbits 2r01000011)))
  (is (= 2r00000001 (s/shiftbits 2r01000100)))
  (is (= 2r00000001 (s/shiftbits 2r01000101)))
  (is (= 2r00000001 (s/shiftbits 2r01000110)))
  (is (= 2r00000001 (s/shiftbits 2r01000111)))
  (is (= 2r00000001 (s/shiftbits 2r01001000)))
  (is (= 2r00000001 (s/shiftbits 2r01001001)))
  (is (= 2r00000001 (s/shiftbits 2r01001010)))
  (is (= 2r00000001 (s/shiftbits 2r01001011)))
  (is (= 2r00000001 (s/shiftbits 2r01001100)))
  (is (= 2r00000001 (s/shiftbits 2r01001101)))
  (is (= 2r00000001 (s/shiftbits 2r01001110)))
  (is (= 2r00000001 (s/shiftbits 2r01001111)))
  (is (= 2r00000001 (s/shiftbits 2r01010000)))
  (is (= 2r00000001 (s/shiftbits 2r01010001)))
  (is (= 2r00000001 (s/shiftbits 2r01010010)))
  (is (= 2r00000001 (s/shiftbits 2r01010011)))
  (is (= 2r00000001 (s/shiftbits 2r01010100)))
  (is (= 2r00000001 (s/shiftbits 2r01010101)))
  (is (= 2r00000001 (s/shiftbits 2r01010110)))
  (is (= 2r00000001 (s/shiftbits 2r01010111)))
  (is (= 2r00000001 (s/shiftbits 2r01011000)))
  (is (= 2r00000001 (s/shiftbits 2r01011001)))
  (is (= 2r00000001 (s/shiftbits 2r01011010)))
  (is (= 2r00000001 (s/shiftbits 2r01011011)))
  (is (= 2r00000001 (s/shiftbits 2r01011100)))
  (is (= 2r00000001 (s/shiftbits 2r01011101)))
  (is (= 2r00000001 (s/shiftbits 2r01011110)))
  (is (= 2r00000001 (s/shiftbits 2r01011111)))
  (is (= 2r00000001 (s/shiftbits 2r01100000)))
  (is (= 2r00000001 (s/shiftbits 2r01100001)))
  (is (= 2r00000001 (s/shiftbits 2r01100010)))
  (is (= 2r00000001 (s/shiftbits 2r01100011)))
  (is (= 2r00000001 (s/shiftbits 2r01100100)))
  (is (= 2r00000001 (s/shiftbits 2r01100101)))
  (is (= 2r00000001 (s/shiftbits 2r01100110)))
  (is (= 2r00000001 (s/shiftbits 2r01100111)))
  (is (= 2r00000001 (s/shiftbits 2r01101000)))
  (is (= 2r00000001 (s/shiftbits 2r01101001)))
  (is (= 2r00000001 (s/shiftbits 2r01101010)))
  (is (= 2r00000001 (s/shiftbits 2r01101011)))
  (is (= 2r00000001 (s/shiftbits 2r01101100)))
  (is (= 2r00000001 (s/shiftbits 2r01101101)))
  (is (= 2r00000001 (s/shiftbits 2r01101110)))
  (is (= 2r00000001 (s/shiftbits 2r01101111)))
  (is (= 2r00000001 (s/shiftbits 2r01110000)))
  (is (= 2r00000001 (s/shiftbits 2r01110001)))
  (is (= 2r00000001 (s/shiftbits 2r01110010)))
  (is (= 2r00000001 (s/shiftbits 2r01110011)))
  (is (= 2r00000001 (s/shiftbits 2r01110100)))
  (is (= 2r00000001 (s/shiftbits 2r01110101)))
  (is (= 2r00000001 (s/shiftbits 2r01110110)))
  (is (= 2r00000001 (s/shiftbits 2r01110111)))
  (is (= 2r00000001 (s/shiftbits 2r01111000)))
  (is (= 2r00000001 (s/shiftbits 2r01111001)))
  (is (= 2r00000001 (s/shiftbits 2r01111010)))
  (is (= 2r00000001 (s/shiftbits 2r01111011)))
  (is (= 2r00000001 (s/shiftbits 2r01111100)))
  (is (= 2r00000001 (s/shiftbits 2r01111101)))
  (is (= 2r00000001 (s/shiftbits 2r01111110)))
  (is (= 2r00000001 (s/shiftbits 2r01111111)))
  (is (= 2r00000010 (s/shiftbits 2r10000000)))
  (is (= 2r00000010 (s/shiftbits 2r10000001)))
  (is (= 2r00000010 (s/shiftbits 2r10000010)))
  (is (= 2r00000010 (s/shiftbits 2r10000011)))
  (is (= 2r00000010 (s/shiftbits 2r10000100)))
  (is (= 2r00000010 (s/shiftbits 2r10000101)))
  (is (= 2r00000010 (s/shiftbits 2r10000110)))
  (is (= 2r00000010 (s/shiftbits 2r10000111)))
  (is (= 2r00000010 (s/shiftbits 2r10001000)))
  (is (= 2r00000010 (s/shiftbits 2r10001001)))
  (is (= 2r00000010 (s/shiftbits 2r10001010)))
  (is (= 2r00000010 (s/shiftbits 2r10001011)))
  (is (= 2r00000010 (s/shiftbits 2r10001100)))
  (is (= 2r00000010 (s/shiftbits 2r10001101)))
  (is (= 2r00000010 (s/shiftbits 2r10001110)))
  (is (= 2r00000010 (s/shiftbits 2r10001111)))
  (is (= 2r00000010 (s/shiftbits 2r10010000)))
  (is (= 2r00000010 (s/shiftbits 2r10010001)))
  (is (= 2r00000010 (s/shiftbits 2r10010010)))
  (is (= 2r00000010 (s/shiftbits 2r10010011)))
  (is (= 2r00000010 (s/shiftbits 2r10010100)))
  (is (= 2r00000010 (s/shiftbits 2r10010101)))
  (is (= 2r00000010 (s/shiftbits 2r10010110)))
  (is (= 2r00000010 (s/shiftbits 2r10010111)))
  (is (= 2r00000010 (s/shiftbits 2r10011000)))
  (is (= 2r00000010 (s/shiftbits 2r10011001)))
  (is (= 2r00000010 (s/shiftbits 2r10011010)))
  (is (= 2r00000010 (s/shiftbits 2r10011011)))
  (is (= 2r00000010 (s/shiftbits 2r10011100)))
  (is (= 2r00000010 (s/shiftbits 2r10011101)))
  (is (= 2r00000010 (s/shiftbits 2r10011110)))
  (is (= 2r00000010 (s/shiftbits 2r10011111)))
  (is (= 2r00000010 (s/shiftbits 2r10100000)))
  (is (= 2r00000010 (s/shiftbits 2r10100001)))
  (is (= 2r00000010 (s/shiftbits 2r10100010)))
  (is (= 2r00000010 (s/shiftbits 2r10100011)))
  (is (= 2r00000010 (s/shiftbits 2r10100100)))
  (is (= 2r00000010 (s/shiftbits 2r10100101)))
  (is (= 2r00000010 (s/shiftbits 2r10100110)))
  (is (= 2r00000010 (s/shiftbits 2r10100111)))
  (is (= 2r00000010 (s/shiftbits 2r10101000)))
  (is (= 2r00000010 (s/shiftbits 2r10101001)))
  (is (= 2r00000010 (s/shiftbits 2r10101010)))
  (is (= 2r00000010 (s/shiftbits 2r10101011)))
  (is (= 2r00000010 (s/shiftbits 2r10101100)))
  (is (= 2r00000010 (s/shiftbits 2r10101101)))
  (is (= 2r00000010 (s/shiftbits 2r10101110)))
  (is (= 2r00000010 (s/shiftbits 2r10101111)))
  (is (= 2r00000010 (s/shiftbits 2r10110000)))
  (is (= 2r00000010 (s/shiftbits 2r10110001)))
  (is (= 2r00000010 (s/shiftbits 2r10110010)))
  (is (= 2r00000010 (s/shiftbits 2r10110011)))
  (is (= 2r00000010 (s/shiftbits 2r10110100)))
  (is (= 2r00000010 (s/shiftbits 2r10110101)))
  (is (= 2r00000010 (s/shiftbits 2r10110110)))
  (is (= 2r00000010 (s/shiftbits 2r10110111)))
  (is (= 2r00000010 (s/shiftbits 2r10111000)))
  (is (= 2r00000010 (s/shiftbits 2r10111001)))
  (is (= 2r00000010 (s/shiftbits 2r10111010)))
  (is (= 2r00000010 (s/shiftbits 2r10111011)))
  (is (= 2r00000010 (s/shiftbits 2r10111100)))
  (is (= 2r00000010 (s/shiftbits 2r10111101)))
  (is (= 2r00000010 (s/shiftbits 2r10111110)))
  (is (= 2r00000010 (s/shiftbits 2r10111111)))
  (is (= 2r00000011 (s/shiftbits 2r11000000)))
  (is (= 2r00000011 (s/shiftbits 2r11000001)))
  (is (= 2r00000011 (s/shiftbits 2r11000010)))
  (is (= 2r00000011 (s/shiftbits 2r11000011)))
  (is (= 2r00000011 (s/shiftbits 2r11000100)))
  (is (= 2r00000011 (s/shiftbits 2r11000101)))
  (is (= 2r00000011 (s/shiftbits 2r11000110)))
  (is (= 2r00000011 (s/shiftbits 2r11000111)))
  (is (= 2r00000011 (s/shiftbits 2r11001000)))
  (is (= 2r00000011 (s/shiftbits 2r11001001)))
  (is (= 2r00000011 (s/shiftbits 2r11001010)))
  (is (= 2r00000011 (s/shiftbits 2r11001011)))
  (is (= 2r00000011 (s/shiftbits 2r11001100)))
  (is (= 2r00000011 (s/shiftbits 2r11001101)))
  (is (= 2r00000011 (s/shiftbits 2r11001110)))
  (is (= 2r00000011 (s/shiftbits 2r11001111)))
  (is (= 2r00000011 (s/shiftbits 2r11010000)))
  (is (= 2r00000011 (s/shiftbits 2r11010001)))
  (is (= 2r00000011 (s/shiftbits 2r11010010)))
  (is (= 2r00000011 (s/shiftbits 2r11010011)))
  (is (= 2r00000011 (s/shiftbits 2r11010100)))
  (is (= 2r00000011 (s/shiftbits 2r11010101)))
  (is (= 2r00000011 (s/shiftbits 2r11010110)))
  (is (= 2r00000011 (s/shiftbits 2r11010111)))
  (is (= 2r00000011 (s/shiftbits 2r11011000)))
  (is (= 2r00000011 (s/shiftbits 2r11011001)))
  (is (= 2r00000011 (s/shiftbits 2r11011010)))
  (is (= 2r00000011 (s/shiftbits 2r11011011)))
  (is (= 2r00000011 (s/shiftbits 2r11011100)))
  (is (= 2r00000011 (s/shiftbits 2r11011101)))
  (is (= 2r00000011 (s/shiftbits 2r11011110)))
  (is (= 2r00000011 (s/shiftbits 2r11011111)))
  (is (= 2r00000011 (s/shiftbits 2r11100000)))
  (is (= 2r00000011 (s/shiftbits 2r11100001)))
  (is (= 2r00000011 (s/shiftbits 2r11100010)))
  (is (= 2r00000011 (s/shiftbits 2r11100011)))
  (is (= 2r00000011 (s/shiftbits 2r11100100)))
  (is (= 2r00000011 (s/shiftbits 2r11100101)))
  (is (= 2r00000011 (s/shiftbits 2r11100110)))
  (is (= 2r00000011 (s/shiftbits 2r11100111)))
  (is (= 2r00000011 (s/shiftbits 2r11101000)))
  (is (= 2r00000011 (s/shiftbits 2r11101001)))
  (is (= 2r00000011 (s/shiftbits 2r11101010)))
  (is (= 2r00000011 (s/shiftbits 2r11101011)))
  (is (= 2r00000011 (s/shiftbits 2r11101100)))
  (is (= 2r00000011 (s/shiftbits 2r11101101)))
  (is (= 2r00000011 (s/shiftbits 2r11101110)))
  (is (= 2r00000011 (s/shiftbits 2r11101111)))
  (is (= 2r00000011 (s/shiftbits 2r11110000)))
  (is (= 2r00000011 (s/shiftbits 2r11110001)))
  (is (= 2r00000011 (s/shiftbits 2r11110010)))
  (is (= 2r00000011 (s/shiftbits 2r11110011)))
  (is (= 2r00000011 (s/shiftbits 2r11110100)))
  (is (= 2r00000011 (s/shiftbits 2r11110101)))
  (is (= 2r00000011 (s/shiftbits 2r11110110)))
  (is (= 2r00000011 (s/shiftbits 2r11110111)))
  (is (= 2r00000011 (s/shiftbits 2r11111000)))
  (is (= 2r00000011 (s/shiftbits 2r11111001)))
  (is (= 2r00000011 (s/shiftbits 2r11111010)))
  (is (= 2r00000011 (s/shiftbits 2r11111011)))
  (is (= 2r00000011 (s/shiftbits 2r11111100)))
  (is (= 2r00000011 (s/shiftbits 2r11111101)))
  (is (= 2r00000011 (s/shiftbits 2r11111110))))

(deftest test-rotbits
  (is (= [0x7F 0x3F 0x1F 0x0F 0x07 0x03 0x01 0x00
          0xFF 0x7F 0x3F 0x1F 0x0F 0x07 0x03 0x01]
         (s/rotbits [0x7F 0xFF]))))
